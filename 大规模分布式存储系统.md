# 大规模分布式存储系统原理解析与架构实战

共305页

# 基础篇
## 1概述
- 云计算
分布式技术+服务化技术+资源隔离和管理(虚拟化技术)

SAAS 软件及服务 最成熟
PAAS 平台即服务
IAAS 基础设施即服务

ZooKeeper
HBase: NoSQL键/值列存储数据库

- Hadoop生态
![Hadoop生态](https://pic1.zhimg.com/4107e092f0b7c1413bf8bd81570d1f74_b.jpg)

- 秒杀器
模拟HTTP交互的网络通信软件
秒杀区和普通网页交互有差别,分析判断


## 2存储系统

master-slave摸索
master: 1)分配任务slave执行 2)协同一致性  接收slave注册,slave死掉需要感知等.
应该将协同的工作分离开.

简化的分布式并行计算设计模型
Fourinone
**包工头/农民工/手工仓库/职介所**

![模型](http://i.imgur.com/7AFHvWm.png)

- 工头:分配任务,计算入口,运行完成退出.
- 职介所:介绍工人给工头  一致性处理  保持联系
- 工人:计算
- 手工仓库:输入输出数据交换


Hadoop:jar包发送到数据节点,计算向数据移动
storm:数据通过消息发送到计算节点,数据向计算移动
Fourinone模型数据和计算相当灵活,自由设计.

- 串行+并行结合满足更多需求

数据拆到不同机器,计算过程也可以拆开.划分多个环节.


- 工人计算的服务化


## 3分布式系统 

- 离线计算:hadoop,日志分析,数据挖掘
- 实时计算:增量计算
- 迭代计算:上一阶段是下一阶段的条件,保留中间结果
- DAG 有向无环图

- 总控节点
	1. 总控节点除了执行全局调度还要维护文件系统目录树,内存容量等成为性能瓶颈
	1. 只维护数据分片位置,一般不会成为瓶颈.google达到8000台机器,hadoop达到3000台机器.
	1. 如果成为瓶颈.增加一层元数据节点.

- 数据库扩容
	主从复制,提高系统读取能力.垂直拆分和水平拆分将数据分布到多个存储节点.

- 异构系统
	- 同构系统
	主从节点,数据完全相同.拷贝过程容易再次发生故障,不适合大规模分布式存储系统.
	- 异构系统
	将数据划分成大小接近的分片,每个分片的多个副本存在任一个存储节点上.恢复时整个集群参与恢复.恢复时间短.

- 两阶段提交协议(TWO-phase commit,2pc)
协调者 参与者.假设每个节点将记录操作日志到非易失性存储上.
阻塞协议,锁住更新.不能容错.
面临两种故障:
	- 参与者故障,可以使用超时机制
	- 协调组故障,记录到日志并同步到备用协调者.
- Paxos协议

	解决多个节点间一致性问题.

	- 批准
	proposer 发送accept消息给其他节点,acceptor接受/拒绝
	- 确认
	超过一半的acceptor接受,提议生效.proposer发送acknowledge消息通过所有acceptor提议生效.



# 范型篇
## 4分布式文件系统
## 5分布键值系统
## 6分布式表格系统
## 7分布式数据库
# 实践篇
## 8OceanBase架构初探
## 9分布式存储引擎
## 10数据库功能
## 11质量保证,运维及实践

#专题篇
## 12云存储
## 13大数据


